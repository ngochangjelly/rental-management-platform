const CACHE_NAME="rental-hub-v3",RUNTIME_CACHE="rental-hub-runtime-v3";async function networkFirstStrategy(t){try{return await fetch(t)}catch(e){return console.log("Network request failed, trying cache"),await caches.match(t)||new Response("Network unavailable",{status:503})}}async function cacheFirstStrategy(t,e){const a=await caches.match(t);if(a)return a;try{const a=await fetch(t);if(a.ok)return(await caches.open(e)).put(t,a.clone()),a}catch(t){console.error("Cache first strategy failed:",t)}return new Response("Resource unavailable",{status:404})}async function staleWhileRevalidateStrategy(t){const e=await caches.match(t),a=fetch(t).then(e=>(e.ok&&caches.open(CACHE_NAME).then(a=>a.put(t,e.clone())),e)).catch(t=>(console.error("Revalidation failed:",t),e));return e||a}async function getOfflineFallback(t){return"document"===t.destination&&await caches.match("/dashboard.html")||new Response("Offline",{status:503})}function doBackgroundSync(){console.log("Background sync triggered")}self.addEventListener("activate",t=>{console.log("Service Worker activating..."),t.waitUntil(Promise.all([caches.keys().then(t=>Promise.all(t.map(t=>{if(t!==CACHE_NAME&&t!==RUNTIME_CACHE)return console.log("Deleting old cache:",t),caches.delete(t)}))),self.clients.claim()]))}),self.addEventListener("sync",t=>{"background-sync"===t.tag&&t.waitUntil(doBackgroundSync())}),self.addEventListener("push",t=>{const e={body:t.data?t.data.text():"New notification from Rental Hub",icon:'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 192"><rect width="192" height="192" fill="%23667eea"/><path fill="white" d="M96 48L48 96h16v48h64V96h16L96 48zm0 16l32 32v40h-16v-16H80v16H64V96l32-32z"/></svg>',badge:'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 192"><rect width="192" height="192" fill="%23667eea"/><path fill="white" d="M96 48L48 96h16v48h64V96h16L96 48zm0 16l32 32v40h-16v-16H80v16H64V96l32-32z"/></svg>',vibrate:[100,50,100],data:{dateOfArrival:Date.now(),primaryKey:1}};t.waitUntil(self.registration.showNotification("Rental Hub",e))}),self.addEventListener("notificationclick",t=>{t.notification.close(),t.waitUntil(clients.openWindow("/dashboard.html"))});